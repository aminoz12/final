const v={fr:{"Explorez l'univers fascinant de l'exploration √©rotique et du bien-√™tre sexuel √† travers des articles √©ducatifs, des guides pratiques et des t√©moignages authentiques. Pour adultes consentants uniquement.":"Explorez l'univers fascinant de l'exploration √©rotique et du bien-√™tre sexuel √† travers des articles √©ducatifs, des guides pratiques et des t√©moignages authentiques. Pour adultes consentants uniquement.","Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu.":"Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu.","Explorer le Blog":"Explorer le Blog","En savoir plus":"En savoir plus","Rejoindre Mad2Moi.com":"Rejoindre Mad2Moi.com","‚ö†Ô∏è Attention : Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu.":"‚ö†Ô∏è Attention : Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu.","Nous sommes d√©di√©s √† l'√©ducation √©rotique, √† l'exploration des plaisirs et √† la promotion d'une sexualit√© √©panouie et responsable. Pour adultes consentants uniquement.":"Nous sommes d√©di√©s √† l'√©ducation √©rotique, √† l'exploration des plaisirs et √† la promotion d'une sexualit√© √©panouie et responsable. Pour adultes consentants uniquement.","Chez Mad2Moi Blog, nous croyons que l'√©ducation sexuelle et l'exploration √©rotique sont des aspects essentiels du bien-√™tre humain. Notre mission est de cr√©er un espace s√ªr et bienveillant o√π les adultes peuvent d√©couvrir, apprendre et explorer leurs d√©sirs en toute confiance.":"Chez Mad2Moi Blog, nous croyons que l'√©ducation sexuelle et l'exploration √©rotique sont des aspects essentiels du bien-√™tre humain. Notre mission est de cr√©er un espace s√ªr et bienveillant o√π les adultes peuvent d√©couvrir, apprendre et explorer leurs d√©sirs en toute confiance.","Nous nous effor√ßons de d√©stigmatiser les pratiques BDSM et le libertinage en fournissant des informations pr√©cises, des conseils de s√©curit√© et des t√©moignages authentiques. Chaque article est soigneusement r√©dig√© pour promouvoir le consentement, la s√©curit√© et le respect mutuel.":"Nous nous effor√ßons de d√©stigmatiser les pratiques BDSM et le libertinage en fournissant des informations pr√©cises, des conseils de s√©curit√© et des t√©moignages authentiques. Chaque article est soigneusement r√©dig√© pour promouvoir le consentement, la s√©curit√© et le respect mutuel.","Blog mature et sophistiqu√© sur l'exploration √©rotique et le bien-√™tre sexuel. Contenu √©ducatif et bienveillant pour adultes consentants.":"Blog mature et sophistiqu√© sur l'exploration √©rotique et le bien-√™tre sexuel. Contenu √©ducatif et bienveillant pour adultes consentants.","¬© 2025 Mad2Moi Blog. Tous droits r√©serv√©s. Contenu pour adultes uniquement.":"¬© 2025 Mad2Moi Blog. Tous droits r√©serv√©s. Contenu pour adultes uniquement.","D√©couvrez les articles les plus populaires de notre communaut√©, tri√©s par engagement et pertinence":"D√©couvrez les articles les plus populaires de notre communaut√©, tri√©s par engagement et pertinence","D√©couvrez d'Autres Articles":"D√©couvrez d'Autres Articles","Continuez votre exploration avec nos articles similaires qui pourraient vous int√©resser.":"Continuez votre exploration avec nos articles similaires qui pourraient vous int√©resser.","Voir Plus d'Articles":"Voir Plus d'Articles","Rejoignez la communaut√© Mad2Moi et d√©couvrez un espace d'exploration √©rotique mature, bienveillant et √©ducatif. Votre voyage commence ici.":"Rejoignez la communaut√© Mad2Moi et d√©couvrez un espace d'exploration √©rotique mature, bienveillant et √©ducatif. Votre voyage commence ici.","Vos informations et conversations restent priv√©es et s√©curis√©es.":"Vos informations et conversations restent priv√©es et s√©curis√©es.","Apprenez et explorez dans un environnement bienveillant et informatif.":"Apprenez et explorez dans un environnement bienveillant et informatif.","Rejoignez des personnes partageant les m√™mes valeurs et int√©r√™ts.":"Rejoignez des personnes partageant les m√™mes valeurs et int√©r√™ts.","üåç {Object.keys(languages).length} langues disponibles":"üåç 7 langues disponibles","Trouvez des r√©ponses claires et expertes √† vos questions sur l'exploration √©rotique, le bien-√™tre sexuel et les pratiques adultes.":"Trouvez des r√©ponses claires et expertes √† vos questions sur l'exploration √©rotique, le bien-√™tre sexuel et les pratiques adultes.","Si vous n'avez pas trouv√© la r√©ponse √† votre question, n'h√©sitez pas √† nous contacter. Notre √©quipe d'experts est l√† pour vous aider.":"Si vous n'avez pas trouv√© la r√©ponse √† votre question, n'h√©sitez pas √† nous contacter. Notre √©quipe d'experts est l√† pour vous aider.","Votre vie priv√©e est importante pour nous. D√©couvrez comment nous prot√©geons vos donn√©es et respectons vos droits.":"Votre vie priv√©e est importante pour nous. D√©couvrez comment nous prot√©geons vos donn√©es et respectons vos droits.","Veuillez lire attentivement ces conditions avant d'utiliser notre site. Votre utilisation du site constitue votre acceptation de ces conditions.":"Veuillez lire attentivement ces conditions avant d'utiliser notre site. Votre utilisation du site constitue votre acceptation de ces conditions.","En utilisant ce site, vous d√©clarez et garantissez que vous avez au moins 18 ans.":"En utilisant ce site, vous d√©clarez et garantissez que vous avez au moins 18 ans.","Tous les contenus sont destin√©s √† des fins √©ducatives et informatives uniquement.":"Tous les contenus sont destin√©s √† des fins √©ducatives et informatives uniquement.","Est prot√©g√© par les droits d'auteur et autres lois sur la propri√©t√© intellectuelle. Toute reproduction ou distribution non autoris√©e est strictement interdite.":"Est prot√©g√© par les droits d'auteur et autres lois sur la propri√©t√© intellectuelle. Toute reproduction ou distribution non autoris√©e est strictement interdite.","Nous nous r√©servons le droit de modifier ces conditions √† tout moment. Les modifications prendront effet imm√©diatement apr√®s leur publication sur le site. Votre utilisation continue du site apr√®s toute modification constitue votre acceptation des nouvelles conditions.":"Nous nous r√©servons le droit de modifier ces conditions √† tout moment. Les modifications prendront effet imm√©diatement apr√®s leur publication sur le site. Votre utilisation continue du site apr√®s toute modification constitue votre acceptation des nouvelles conditions.","Nous pouvons suspendre ou r√©silier votre acc√®s au site √† tout moment, sans pr√©avis, pour violation de ces conditions ou pour toute autre raison. Vous pouvez √©galement cesser d'utiliser le site √† tout moment.":"Nous pouvons suspendre ou r√©silier votre acc√®s au site √† tout moment, sans pr√©avis, pour violation de ces conditions ou pour toute autre raison. Vous pouvez √©galement cesser d'utiliser le site √† tout moment.","Ces conditions sont r√©gies et interpr√©t√©es conform√©ment aux lois fran√ßaises. Tout litige sera soumis √† la comp√©tence exclusive des tribunaux fran√ßais.":"Ces conditions sont r√©gies et interpr√©t√©es conform√©ment aux lois fran√ßaises. Tout litige sera soumis √† la comp√©tence exclusive des tribunaux fran√ßais.","Notre √©quipe est l√† pour clarifier tout point concernant nos conditions d'utilisation et vous aider √† comprendre vos droits et responsabilit√©s.":"Notre √©quipe est l√† pour clarifier tout point concernant nos conditions d'utilisation et vous aider √† comprendre vos droits et responsabilit√©s.","Explorez nos diff√©rentes cat√©gories de contenu et trouvez ce qui vous int√©resse le plus":"Explorez nos diff√©rentes cat√©gories de contenu et trouvez ce qui vous int√©resse le plus","üí° Tapez pour voir les suggestions ‚Ä¢ Utilisez ‚Üë‚Üì pour naviguer ‚Ä¢ Appuyez sur Entr√©e pour rechercher":"üí° Tapez pour voir les suggestions ‚Ä¢ Utilisez ‚Üë‚Üì pour naviguer ‚Ä¢ Appuyez sur Entr√©e pour rechercher","R√©sultats de recherche":"R√©sultats de recherche","Toutes nos cat√©gories":"Toutes nos cat√©gories",cat√©gorie:"cat√©gorie",cat√©gories:"cat√©gories",trouv√©e:"trouv√©e",trouv√©es:"trouv√©es","Articles populaires :":"Articles populaires :",Explorer:"Explorer","Aucune cat√©gorie trouv√©e":"Aucune cat√©gorie trouv√©e","Aucune cat√©gorie ne correspond √† votre recherche. Essayez avec d'autres mots-cl√©s ou parcourez toutes nos cat√©gories.":"Aucune cat√©gorie ne correspond √† votre recherche. Essayez avec d'autres mots-cl√©s ou parcourez toutes nos cat√©gories.","Voir toutes les cat√©gories":"Voir toutes les cat√©gories","Statistiques du Blog":"Statistiques du Blog","D√©couvrez l'√©tendue de notre contenu √©ducatif":"D√©couvrez l'√©tendue de notre contenu √©ducatif","Articles Totaux":"Articles Totaux",Cat√©gories:"Cat√©gories",Auteurs:"Auteurs","Contenu Mature":"Contenu Mature","Explorez nos articles √©ducatifs sur l'exploration √©rotique et le bien-√™tre sexuel":"Explorez nos articles √©ducatifs sur l'exploration √©rotique et le bien-√™tre sexuel",article:"article",articles:"articles",trouv√©:"trouv√©",trouv√©s:"trouv√©s","au total":"au total","Questions Fr√©quentes":"Questions Fr√©quentes","questions r√©pondues":"questions r√©pondues","Besoin d'Aide Suppl√©mentaire ?":"Besoin d'Aide Suppl√©mentaire ?","Nous Contacter":"Nous Contacter","Consulter la FAQ":"Consulter la FAQ","Questions sur la Confidentialit√© ?":"Questions sur la Confidentialit√© ?","Notre √©quipe est l√† pour r√©pondre √† toutes vos questions concernant la protection de vos donn√©es personnelles.":"Notre √©quipe est l√† pour r√©pondre √† toutes vos questions concernant la protection de vos donn√©es personnelles.","Politique de Confidentialit√©":"Politique de Confidentialit√©","Questions sur les Conditions ?":"Questions sur les Conditions ?","Notre √©quipe est l√† pour clarifier tout point concernant nos conditions d'utilisation et vous aider √† comprendre vos droits et responsabilit√©s.":"Notre √©quipe est l√† pour clarifier tout point concernant nos conditions d'utilisation et vous aider √† comprendre vos droits et responsabilit√©s.","Choisissez votre langue pr√©f√©r√©e":"Choisissez votre langue pr√©f√©r√©e"},en:{"Explorez l'univers fascinant de l'exploration √©rotique et du bien-√™tre sexuel √† travers des articles √©ducatifs, des guides pratiques et des t√©moignages authentiques. Pour adultes consentants uniquement.":"Explore the fascinating world of erotic exploration and sexual well-being through educational articles, practical guides and authentic testimonials. For consenting adults only.","Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu.":"This blog contains explicit content intended for adults. You must be 18 years or older to access this content.","Explorer le Blog":"Explore the Blog","En savoir plus":"Learn More","Rejoindre Mad2Moi.com":"Join Mad2Moi.com","‚ö†Ô∏è Attention : Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu.":"‚ö†Ô∏è Warning: This blog contains explicit content intended for adults. You must be 18 years or older to access this content.","Nous sommes d√©di√©s √† l'√©ducation √©rotique, √† l'exploration des plaisirs et √† la promotion d'une sexualit√© √©panouie et responsable. Pour adultes consentants uniquement.":"We are dedicated to erotic education, pleasure exploration and promoting fulfilled and responsible sexuality. For consenting adults only.","Chez Mad2Moi Blog, nous croyons que l'√©ducation sexuelle et l'exploration √©rotique sont des aspects essentiels du bien-√™tre humain. Notre mission est de cr√©er un espace s√ªr et bienveillant o√π les adultes peuvent d√©couvrir, apprendre et explorer leurs d√©sirs en toute confiance.":"At Mad2Moi Blog, we believe that sexual education and erotic exploration are essential aspects of human well-being. Our mission is to create a safe and caring space where adults can discover, learn and explore their desires with confidence.","Nous nous effor√ßons de d√©stigmatiser les pratiques BDSM et le libertinage en fournissant des informations pr√©cises, des conseils de s√©curit√© et des t√©moignages authentiques. Chaque article est soigneusement r√©dig√© pour promouvoir le consentement, la s√©curit√© et le respect mutuel.":"We strive to destigmatize BDSM practices and libertinism by providing accurate information, safety advice and authentic testimonials. Each article is carefully written to promote consent, safety and mutual respect.","Blog mature et sophistiqu√© sur l'exploration √©rotique et le bien-√™tre sexuel. Contenu √©ducatif et bienveillant pour adultes consentants.":"Mature and sophisticated blog about erotic exploration and sexual well-being. Educational and caring content for consenting adults.","¬© 2025 Mad2Moi Blog. Tous droits r√©serv√©s. Contenu pour adultes uniquement.":"¬© 2025 Mad2Moi Blog. All rights reserved. Adult content only.","D√©couvrez les articles les plus populaires de notre communaut√©, tri√©s par engagement et pertinence":"Discover the most popular articles from our community, sorted by engagement and relevance","D√©couvrez d'Autres Articles":"Discover Other Articles","Continuez votre exploration avec nos articles similaires qui pourraient vous int√©resser.":"Continue your exploration with our similar articles that might interest you.","Voir Plus d'Articles":"See More Articles","Rejoignez la communaut√© Mad2Moi et d√©couvrez un espace d'exploration √©rotique mature, bienveillant et √©ducatif. Votre voyage commence ici.":"Join the Mad2Moi community and discover a mature, caring and educational erotic exploration space. Your journey begins here.","Vos informations et conversations restent priv√©es et s√©curis√©es.":"Your information and conversations remain private and secure.","Apprenez et explorez dans un environnement bienveillant et informatif.":"Learn and explore in a caring and informative environment.","Rejoignez des personnes partageant les m√™mes valeurs et int√©r√™ts.":"Join people sharing the same values and interests.","üåç {Object.keys(languages).length} langues disponibles":"üåç 7 languages available","Trouvez des r√©ponses claires et expertes √† vos questions sur l'exploration √©rotique, le bien-√™tre sexuel et les pratiques adultes.":"Find clear and expert answers to your questions about erotic exploration, sexual well-being and adult practices.","Si vous n'avez pas trouv√© la r√©ponse √† votre question, n'h√©sitez pas √† nous contacter. Notre √©quipe d'experts est l√† pour vous aider.":"If you haven't found the answer to your question, don't hesitate to contact us. Our team of experts is here to help you.","Votre vie priv√©e est importante pour nous. D√©couvrez comment nous prot√©geons vos donn√©es et respectons vos droits.":"Your privacy is important to us. Discover how we protect your data and respect your rights.","Veuillez lire attentivement ces conditions avant d'utiliser notre site. Votre utilisation du site constitue votre acceptation de ces conditions.":"Please read these terms carefully before using our site. Your use of the site constitutes your acceptance of these terms.","En utilisant ce site, vous d√©clarez et garantissez que vous avez au moins 18 ans.":"By using this site, you declare and warrant that you are at least 18 years old.","Tous les contenus sont destin√©s √† des fins √©ducatives et informatives uniquement.":"All content is intended for educational and informational purposes only.","Est prot√©g√© par les droits d'auteur et autres lois sur la propri√©t√© intellectuelle. Toute reproduction ou distribution non autoris√©e est strictement interdite.":"Is protected by copyright and other intellectual property laws. Any unauthorized reproduction or distribution is strictly prohibited.","Nous nous r√©servons le droit de modifier ces conditions √† tout moment. Les modifications prendront effet imm√©diatement apr√®s leur publication sur le site. Votre utilisation continue du site apr√®s toute modification constitue votre acceptation des nouvelles conditions.":"We reserve the right to modify these terms at any time. Changes will take effect immediately after their publication on the site. Your continued use of the site after any modification constitutes your acceptance of the new terms.","Nous pouvons suspendre ou r√©silier votre acc√®s au site √† tout moment, sans pr√©avis, pour violation de ces conditions ou pour toute autre raison. Vous pouvez √©galement cesser d'utiliser le site √† tout moment.":"We may suspend or terminate your access to the site at any time, without notice, for violation of these terms or for any other reason. You may also stop using the site at any time.","Ces conditions sont r√©gies et interpr√©t√©es conform√©ment aux lois fran√ßaises. Tout litige sera soumis √† la comp√©tence exclusive des tribunaux fran√ßais.":"These terms are governed and interpreted in accordance with French laws. Any dispute will be submitted to the exclusive jurisdiction of French courts.","Notre √©quipe est l√† pour clarifier tout point concernant nos conditions d'utilisation et vous aider √† comprendre vos droits et responsabilit√©s.":"Our team is here to clarify any point regarding our terms of use and help you understand your rights and responsibilities.","Explorez nos diff√©rentes cat√©gories de contenu et trouvez ce qui vous int√©resse le plus":"Explore our different content categories and find what interests you most","üí° Tapez pour voir les suggestions ‚Ä¢ Utilisez ‚Üë‚Üì pour naviguer ‚Ä¢ Appuyez sur Entr√©e pour rechercher":"üí° Type to see suggestions ‚Ä¢ Use ‚Üë‚Üì to navigate ‚Ä¢ Press Enter to search","R√©sultats de recherche":"Search results","Toutes nos cat√©gories":"All our categories",cat√©gorie:"category",cat√©gories:"categories",trouv√©e:"found",trouv√©es:"found","Articles populaires :":"Popular articles:",Explorer:"Explore","Aucune cat√©gorie trouv√©e":"No category found","Aucune cat√©gorie ne correspond √† votre recherche. Essayez avec d'autres mots-cl√©s ou parcourez toutes nos cat√©gories.":"No category matches your search. Try other keywords or browse all our categories.","Voir toutes les cat√©gories":"See all categories","Statistiques du Blog":"Blog Statistics","D√©couvrez l'√©tendue de notre contenu √©ducatif":"Discover the extent of our educational content","Articles Totaux":"Total Articles",Cat√©gories:"Categories",Auteurs:"Authors","Contenu Mature":"Mature Content","Explorez nos articles √©ducatifs sur l'exploration √©rotique et le bien-√™tre sexuel":"Explore our educational articles on erotic exploration and sexual well-being",article:"article",articles:"articles",trouv√©:"found",trouv√©s:"found","au total":"total","Questions Fr√©quentes":"Frequently Asked Questions","questions r√©pondues":"questions answered","Besoin d'Aide Suppl√©mentaire ?":"Need Additional Help?","Nous Contacter":"Contact Us","Consulter la FAQ":"Consult FAQ","Questions sur la Confidentialit√© ?":"Questions about Privacy?","Notre √©quipe est l√† pour r√©pondre √† toutes vos questions concernant la protection de vos donn√©es personnelles.":"Our team is here to answer all your questions about protecting your personal data.","Politique de Confidentialit√©":"Privacy Policy","Questions sur les Conditions ?":"Questions about Terms?","Notre √©quipe est l√† pour clarifier tout point concernant nos conditions d'utilisation et vous aider √† comprendre vos droits et responsabilit√©s.":"Our team is here to clarify any point regarding our terms of use and help you understand your rights and responsibilities.","Choisissez votre langue pr√©f√©r√©e":"Choose your preferred language"}};function f(s){document.querySelectorAll("[data-translate]").forEach(e=>{const t=e.getAttribute("data-translate");v[s]&&v[s][t]&&(e.textContent=v[s][t])})}document.addEventListener("languageChanged",s=>{f(s.detail.language)});document.addEventListener("DOMContentLoaded",()=>{f("fr")});document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("cookie-consent"),e=document.getElementById("accept-cookies"),t=document.getElementById("decline-cookies");!localStorage.getItem("cookie-consent")&&s&&s.classList.remove("hidden"),e&&e.addEventListener("click",()=>{localStorage.setItem("cookie-consent","accepted"),s?.classList.add("hidden")}),t&&t.addEventListener("click",()=>{localStorage.setItem("cookie-consent","declined"),s?.classList.add("hidden")})});document.querySelectorAll('a[href^="#"]').forEach(s=>{s.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})});const p=document.createElement("button");p.innerHTML="‚Üë";p.className="fixed bottom-8 right-8 w-12 h-12 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white rounded-full shadow-lg transition-all duration-300 opacity-0 invisible z-40 hover:scale-110";p.setAttribute("aria-label","Retour en haut");document.body.appendChild(p);window.addEventListener("scroll",()=>{window.pageYOffset>300?p.classList.remove("opacity-0","invisible"):p.classList.add("opacity-0","invisible")});p.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});class b{constructor(){this.ws=null,this.isConnected=!1,this.sessionId=this.generateSessionId(),this.userName=this.getUserName(),this.userEmail=this.getUserEmail(),this.currentAttachment=null,this.conversationId=null,this.initializeElements(),this.initializeWebSocket(),this.setupEventListeners(),this.loadChatHistory(),this.startConversation()}initializeElements(){this.chatToggleBtn=document.getElementById("chatToggleBtn"),this.chatWindow=document.getElementById("chatWindow"),this.closeChatBtn=document.getElementById("closeChatBtn"),this.chatMessages=document.getElementById("chatMessages"),this.chatInput=document.getElementById("chatInput"),this.sendChatBtn=document.getElementById("sendChatBtn"),this.typingIndicator=document.getElementById("typingIndicator"),this.emojiToggleBtn=document.getElementById("emojiToggleBtn"),this.emojiPicker=document.getElementById("emojiPicker"),this.attachmentBtn=document.getElementById("attachmentBtn"),this.imageBtn=document.getElementById("imageBtn"),this.fileInput=document.getElementById("fileInput")}generateSessionId(){return"session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}getUserName(){return localStorage.getItem("chatUserName")||`Visiteur_${Math.floor(Math.random()*1e3)}`}getUserEmail(){return localStorage.getItem("chatUserEmail")||null}async initializeWebSocket(){try{if(!window.WebSocket)throw new Error("WebSocket not supported");const t=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/chat`;this.ws=new WebSocket(t),this.ws.onopen=()=>{console.log("‚úÖ Chat WebSocket connected"),this.isConnected=!0,this.registerClient()},this.ws.onmessage=o=>{this.handleWebSocketMessage(JSON.parse(o.data))},this.ws.onclose=()=>{console.log("üîå Chat WebSocket disconnected"),this.isConnected=!1,setTimeout(()=>{this.isConnected||this.initializeWebSocket()},5e3)},this.ws.onerror=o=>{console.error("‚ùå Chat WebSocket error:",o)}}catch(e){console.error("‚ùå Failed to initialize chat WebSocket:",e)}}registerClient(){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"register_client",data:{sessionId:this.sessionId,userId:this.sessionId,name:this.userName,conversationId:this.conversationId}}))}handleWebSocketMessage(e){switch(console.log("üì® Chat message received:",e),e.type){case"connection_established":console.log("‚úÖ Chat connection established");break;case"client_registered":console.log("üë§ Client registered successfully");break;case"new_message":e.data.conversation_id===this.conversationId&&this.addMessageToUI(e.data);break;case"admin_availability_changed":this.updateAdminAvailability(e.available);break;default:console.warn("‚ö†Ô∏è Unknown chat message type:",e.type)}}async loadChatHistory(){try{console.log("üìö Chat history loaded")}catch(e){console.error("‚ùå Error loading chat history:",e)}}async startConversation(){try{console.log("üöÄ Starting new chat conversation...");const e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"start_conversation",session_id:this.sessionId,visitor_name:this.userName,visitor_email:this.userEmail})});if(!e.ok)throw new Error(`Failed to start conversation: ${e.status}`);const t=await e.json();this.conversationId=t.conversation_id,console.log("‚úÖ Conversation started with ID:",this.conversationId),await this.loadConversationMessages()}catch(e){console.error("‚ùå Error starting conversation:",e),this.showNotification("Erreur lors du d√©marrage du chat","error")}}async loadConversationMessages(){if(this.conversationId)try{const e=await fetch(`/api/chat?action=messages&conversation_id=${this.conversationId}`);if(e.ok){const t=await e.json();this.chatMessages.innerHTML="",t.forEach(o=>{this.addMessageToUI({id:o.id,message:o.message,sender:o.sender_type==="visitor"?"user":o.sender_type,timestamp:o.created_at,attachment:null})})}}catch(e){console.error("‚ùå Error loading conversation messages:",e)}}async sendMessage(){const e=this.chatInput.value.trim();if(e){this.chatInput.value="";try{if(!this.conversationId&&(await this.startConversation(),!this.conversationId))throw new Error("Failed to start conversation");if(this.addMessageToUI({id:Date.now(),message:e,sender:"user",timestamp:new Date().toISOString(),attachment:this.currentAttachment}),this.ws&&this.ws.readyState===WebSocket.OPEN)this.ws.send(JSON.stringify({type:"send_message",data:{userId:this.sessionId,message:e,sessionId:this.sessionId,conversationId:this.conversationId,attachment:this.currentAttachment}}));else if(!(await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"send_message",conversation_id:this.conversationId,message:e,sender_type:"visitor",attachment:this.currentAttachment})})).ok)throw new Error("Failed to send message");this.currentAttachment=null}catch(t){console.error("‚ùå Error sending message:",t),this.showNotification("Erreur lors de l'envoi du message","error")}}}addMessageToUI(e){const t=e.sender==="user",o=`
      <div class="flex ${t?"justify-end":"justify-start"}">
        <div class="bg-${t?"blue-500 text-white":"gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"} px-3 py-2 rounded-lg max-w-xs">
          <div class="text-xs opacity-75 mb-1">${t?"Vous":e.sender==="admin"?"Support":"GPT-5"} ‚Ä¢ ${this.formatTimestamp(e.timestamp)}</div>
          <div>${this.escapeHtml(e.message)}</div>
          ${e.attachment?this.renderAttachment(e.attachment):""}
        </div>
      </div>
    `;this.chatMessages.insertAdjacentHTML("beforeend",o),this.scrollToBottom()}renderAttachment(e){return e.type&&e.type.startsWith("image/")?`<img src="${e.url}" alt="Image" class="mt-2 max-w-full rounded">`:'<div class="mt-2 text-sm opacity-75">üìé Pi√®ce jointe</div>'}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}scrollToBottom(){this.chatMessages.scrollTop=this.chatMessages.scrollHeight}formatTimestamp(e){if(!e)return"";const t=new Date(e),i=(new Date-t)/(1e3*60*60);return i<1?"√Ä l'instant":i<24?t.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"2-digit"})}updateAdminAvailability(e){const t=document.querySelector(".w-2.h-2.bg-green-400");t&&(t.className=`w-2 h-2 ${e?"bg-green-400":"bg-gray-400"} rounded-full ${e?"animate-pulse":""}`);const o=document.querySelector(".bg-blue-600 h3 + p");o&&(o.textContent=e?"Comment pouvons-nous vous aider ?":"Support temporairement indisponible")}showNotification(e,t="info"){console.log(`${t.toUpperCase()}: ${e}`)}setupEventListeners(){this.chatToggleBtn.addEventListener("click",()=>{this.chatWindow.classList.toggle("hidden"),this.chatWindow.classList.contains("hidden")||this.chatInput.focus()}),this.closeChatBtn.addEventListener("click",()=>{this.chatWindow.classList.add("hidden")}),this.sendChatBtn.addEventListener("click",()=>this.sendMessage()),this.chatInput.addEventListener("keypress",e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),this.sendMessage())}),this.emojiToggleBtn.addEventListener("click",()=>{this.emojiPicker.classList.toggle("hidden")}),this.emojiPicker.addEventListener("click",e=>{if(e.target.classList.contains("emoji-btn")){const t=e.target.dataset.emoji;this.chatInput.value+=t,this.emojiPicker.classList.add("hidden"),this.chatInput.focus()}}),this.attachmentBtn.addEventListener("click",()=>{this.fileInput.accept=".pdf,.doc,.docx,.txt",this.fileInput.click()}),this.imageBtn.addEventListener("click",()=>{this.fileInput.accept="image/*",this.fileInput.click()}),this.fileInput.addEventListener("change",e=>{const t=e.target.files[0];t&&this.handleFileUpload(t)}),document.addEventListener("click",e=>{!this.emojiPicker.contains(e.target)&&!this.emojiToggleBtn.contains(e.target)&&this.emojiPicker.classList.add("hidden")})}async handleFileUpload(e){try{if(e.type.startsWith("image/")){const t=new FileReader;t.onload=o=>{this.currentAttachment={name:e.name,type:e.type,url:o.target.result,size:e.size},this.showNotification(`Image "${e.name}" pr√™te √† √™tre envoy√©e`,"info")},t.readAsDataURL(e)}else this.currentAttachment={name:e.name,type:e.type,size:e.size},this.showNotification(`Fichier "${e.name}" pr√™t √† √™tre envoy√©`,"info")}catch(t){console.error("‚ùå Error handling file upload:",t),this.showNotification("Erreur lors du traitement du fichier","error")}}}document.addEventListener("DOMContentLoaded",()=>{new b});document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("mobile-menu-button"),e=document.getElementById("mobile-menu");s&&e&&s.addEventListener("click",()=>{e.classList.toggle("hidden"),e.classList.contains("hidden")||e.classList.add("animate-slide-down")});const t=window.location.pathname;document.querySelectorAll(".nav-link, .mobile-nav-link").forEach(i=>{const n=i.getAttribute("href");(n===t||n==="/blog"&&t.startsWith("/blog"))&&i.classList.add("active")}),document.addEventListener("click",i=>{e&&!e.contains(i.target)&&!s?.contains(i.target)&&e.classList.add("hidden")})});window.translateEntirePage=async function(s){if(console.log("üåç GLOBAL TRANSLATION STARTING to:",s),s==="fr"){restoreOriginalText();return}await C(s)};async function y(s,e,t){const o=document.createElement("div");if(o.innerHTML=s,o.children.length===0)return e;try{let n=function(r){const u=document.createTreeWalker(r,NodeFilter.SHOW_TEXT,null,!1);let c;for(;c=u.nextNode();){const l=c.textContent.trim();l&&l.length>0&&l.includes(t)&&(c.textContent=l.replace(t,e))}};var i=n;const a=o.cloneNode(!0);return n(a),a.innerHTML}catch(n){return console.error("‚ùå Error in translateHTMLContent:",n),s.replace(t,e)}}async function x(s){const e=document.querySelectorAll("[data-translate]");console.log(`üéØ Found ${e.length} data-translate elements`);for(const t of e){if(t.hasAttribute("data-translated"))continue;const o=t.textContent.trim();if(!(o.length<3))try{const i=t.innerHTML;t.setAttribute("data-original-content",i),t.setAttribute("data-translated","true"),t.innerHTML='<span class="text-blue-400 italic">üîÑ</span>';const n=await h(o,"fr",s);let a=i;if(t.children.length>0||i.includes("<")){const r=new RegExp(o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g");a=i.replace(r,n)}t.innerHTML=a,console.log(`‚úÖ Translated data-translate: "${o}" ‚Üí "${n}"`)}catch(i){console.error("‚ùå Translation error for data-translate:",o,i),t.innerHTML=o,t.removeAttribute("data-translated")}}}async function w(){console.log("üßπ Cleaning up mixed language text...");const s=["l'univers","fascinant","exploration","√©rotique","bien-√™tre","sexuel","articles","√©ducatifs","guides","pratiques","t√©moignages","authentiques","contenu","explicite","destin√©","adultes","devez","avoir","ans","plus","acc√©der","ce","blog","contient","du","de","√†","pour","et","avec","dans","sur","par","les","des","une","un","est","sont","√™tre"],e=document.querySelectorAll("*");for(const t of e){if(t.hasAttribute("data-translated"))continue;const o=t.textContent.trim();if(o&&o.length>10){let i=!1;for(const n of s)if(o.includes(n)){i=!0;break}if(i){console.log(`üßπ Found mixed language text: "${o}"`);const n=t.getAttribute("data-original-content");n&&(t.innerHTML=n,t.removeAttribute("data-translated"),console.log("‚úÖ Restored original French text"))}}}console.log("üßπ Finished cleaning up mixed language text")}async function E(s){console.log("üéØ FORCING translation of problematic content..."),await w();const e=["Explorez l'univers fascinant de l'exploration √©rotique et du bien-√™tre sexuel √† travers des articles √©ducatifs, des guides pratiques et des t√©moignages authentiques","Ce blog contient du contenu explicite destin√© aux adultes. Vous devez avoir 18 ans ou plus pour acc√©der √† ce contenu","Recevez nos meilleurs articles directement dans votre bo√Æte mail","En vous abonnant, vous acceptez notre","√Ä propos de Mad2Moi Blog","Nous sommes d√©di√©s √† l'√©ducation √©rotique, √† l'exploration des plaisirs et √† la promotion d'une sexualit√© √©panouie et responsable","Commencez votre voyage d'exploration √©rotique avec nos articles √©ducatifs et nos guides pratiques","Rappel important : Ce blog est destin√© aux adultes de 18 ans et plus. Toutes nos recommandations supposent des partenaires consentants et des pratiques s√©curis√©es","Contactez Mad2Moi Blog","J'accepte que mes donn√©es soient trait√©es conform√©ment √† la","Cat√©gories Mad2Moi","Explorez l'univers fascinating de l'exploration √©rotique et du bien-√™tre sexual √† travers of articles √©ducatifs, of guides practical et of t√©moignages authentic","l'univers fascinating","bien-√™tre sexual","of articles √©ducatifs","of guides practical","of t√©moignages authentic"];for(const t of e)try{const o=document.querySelectorAll("*");for(const i of o){if(i.hasAttribute("data-translated")||i.hasAttribute("data-original-content"))continue;const n=i.textContent.trim();if(n.includes(t)&&n.length>10){console.log(`üéØ Found problematic text: "${t}" in element:`,i);const a=i.innerHTML;i.setAttribute("data-original-content",a),i.setAttribute("data-translated","true");const r=await h(n,"fr",s);if(a.includes("<")){const u=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),c=a.replace(u,r);i.innerHTML=c}else i.textContent=r;console.log(`‚úÖ FORCED translation of problematic text: "${n}" ‚Üí "${r}"`);break}}}catch(o){console.error("‚ùå Error forcing translation of problematic text:",t,o)}console.log("üéØ Finished forcing translation of problematic content")}async function C(s){console.log(`üåç Starting translation to ${s}...`),await x(s),await E(s);const e=["h1","h2","h3","h4","h5","h6","p","span","div","a","button","label","li","td","th","input[placeholder]","textarea[placeholder]","strong","em","b","i","figcaption","caption","small","sub","sup"];let t=0,o=0;const i=document.querySelectorAll("input[placeholder], textarea[placeholder]");for(const n of i){const a=n.getAttribute("placeholder");if(a&&a.trim().length>0)try{n.hasAttribute("data-original-placeholder")||n.setAttribute("data-original-placeholder",a);const r=await h(a,"fr",s);n.setAttribute("placeholder",r),o++,console.log(`‚úÖ Translated placeholder: "${a}" ‚Üí "${r}"`)}catch(r){console.error("‚ùå Placeholder translation error:",r)}}for(const n of e){const a=document.querySelectorAll(n);for(const r of a){if(r.hasAttribute("data-translated")||r.hasAttribute("data-original-content")||!r.textContent||r.textContent.trim().length===0)continue;const u=["span","strong","em","b","i"];if(Array.from(r.children).some(d=>!u.includes(d.tagName.toLowerCase())))continue;let l=r.textContent.trim();if(!(l.length<3||l.includes("http")||l.includes("@")||l.includes("+33")||l.includes("mad2moi.com")||l.includes("localhost"))&&!q(l,s)){if(r.hasAttribute("data-translate")&&!["le","la","les","de","du","des","et","ou","avec","pour","sur","dans","est","sont","avoir","√™tre"].some(m=>l.toLowerCase().includes(m))){console.log(`‚ö†Ô∏è Skipping non-French text: "${l}"`);continue}try{t++;const d=r.innerHTML;r.setAttribute("data-original-content",d),r.setAttribute("data-translated","true"),r.innerHTML='<span class="text-blue-400 italic">üîÑ</span>';const g=await h(l,"fr",s);let m=d;r.children.length>0?m=await y(d,g,l):m=g,r.innerHTML=m,o++,console.log(`‚úÖ Translated: "${l}" ‚Üí "${g}"`)}catch(d){console.error("‚ùå Translation error for:",l,d),r.innerHTML=l,r.removeAttribute("data-translated")}}}}console.log(`üéØ GLOBAL TRANSLATION COMPLETE: ${o}/${t} elements translated`)}function q(s,e){const t=["le","la","les","de","du","des","et","ou","avec","pour","sur","dans","est","sont","avoir","√™tre","ce","cette","ces","qui","que","quoi","o√π","quand","comment","pourquoi"],o=["the","and","or","with","for","on","in","at","to","of","a","an","is","are","have","has","this","that","these","those","who","what","where","when","how","why"],i=["der","die","das","und","oder","mit","f√ºr","auf","in","an","zu","von","ist","sind","haben","hat","dieser","diese","dieses","wer","was","wo","wann","wie","warum"],n=s.toLowerCase().split(/\s+/);let a=0,r=0,u=0;return n.forEach(c=>{const l=c.replace(/[^\w]/g,"");l.length<2||(t.includes(l)&&a++,o.includes(l)&&r++,i.includes(l)&&u++)}),e==="en"&&r>=2&&r>a||e==="de"&&u>=2&&u>a}async function h(s,e,t){try{const o=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${e}&tl=${t}&dt=t&q=${encodeURIComponent(s)}`,n=await(await fetch(o)).json();let a="";return n&&n[0]&&n[0][0]&&(a=n[0][0][0]),a||s}catch(o){console.error("Google Translate error:",o);try{const i=await fetch("https://libretranslate.com/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({q:s,source:e,target:t,format:"text"})});if(i.ok)return(await i.json()).translatedText||s}catch(i){console.error("LibreTranslate fallback also failed:",i)}return s}}window.restoreOriginalText=function(){console.log("üîÑ Restoring ALL original text");const s=document.querySelectorAll("[data-original-placeholder]");s.forEach(t=>{const o=t.getAttribute("data-original-placeholder");o&&(t.setAttribute("placeholder",o),t.removeAttribute("data-original-placeholder"))});const e=document.querySelectorAll("[data-original-content]");e.forEach(t=>{const o=t.getAttribute("data-original-content");o&&(t.innerHTML=o,t.removeAttribute("data-original-content"),t.removeAttribute("data-translated"))}),console.log(`üîÑ Restored ${e.length} elements and ${s.length} placeholders to French`)};document.addEventListener("DOMContentLoaded",()=>{console.log("üöÄ GLOBAL TRANSLATOR initialized - Will translate ALL text on the page");const s=localStorage.getItem("selectedLanguage");s&&s!=="fr"&&(console.log("üîÑ Auto-translating page to:",s),setTimeout(()=>{window.translateEntirePage(s)},1e3))});window.addEventListener("languageChanged",s=>{const e=s.detail.language;console.log("üåç Language changed to:",e),localStorage.setItem("selectedLanguage",e),e==="fr"?(console.log("üîÑ Restoring French text..."),restoreOriginalText()):(console.log("üîÑ Translating page to:",e),window.translateEntirePage(e))});document.addEventListener("DOMContentLoaded",()=>{const s=document.querySelectorAll(".language-option"),e=document.getElementById("current-language-name"),t=document.querySelector("#language-selector-btn img");let o=localStorage.getItem("selectedLanguage")||"fr";function i(n){const a={fr:"Fran√ßais",en:"English",de:"Deutsch",it:"Italiano",pt:"Portugu√™s",es:"Espa√±ol",nl:"Nederlands"};e&&(e.textContent=a[n]||a.fr),t&&(t.src=`/images/flags/${n}.svg`,t.onerror=function(){this.src="/images/flags/default.svg"}),localStorage.setItem("selectedLanguage",n),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:n}}))}s.forEach(n=>{n.addEventListener("click",()=>{const a=n.getAttribute("data-lang");o=a,i(a);const r=n.closest(".group");r&&r.classList.remove("group-hover:opacity-100","group-hover:visible")})}),i(o)});
