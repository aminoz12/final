let a=!0;const i=document.getElementById("body"),m=document.getElementById("modeToggle"),c=document.getElementById("sunIcon"),d=document.getElementById("moonIcon");function u(){a=!a,a?(i.className="min-h-screen gradient-bg-dark mode-transition flex items-center justify-center p-4 overflow-hidden",c.classList.add("hidden"),d.classList.remove("hidden")):(i.className="min-h-screen gradient-bg-light mode-transition flex items-center justify-center p-4 overflow-hidden",d.classList.add("hidden"),c.classList.remove("hidden"))}u();m.addEventListener("click",u);document.getElementById("loginForm").addEventListener("submit",async function(l){l.preventDefault(),console.log("üöÄ Login form submitted - Starting authentication process...");const n=document.getElementById("username").value,r=document.getElementById("password").value,o=document.getElementById("errorMessage"),e=document.querySelector('button[type="submit"]');console.log("üìù Form data:",{username:n,password:"***"}),e.innerHTML='<span class="relative z-10 flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Connexion...</span>',e.disabled=!0,o.classList.add("hidden"),setTimeout(async()=>{try{console.log("üîç Checking credentials...");try{const t=await fetch("/api/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:r})});if(!t.ok)throw new Error("Nom d'utilisateur ou mot de passe invalide");const s=await t.json();localStorage.setItem("sessionId",s.sessionId),localStorage.setItem("adminUser",s.user?.username||n),localStorage.setItem("adminRole",s.user?.role||"author"),localStorage.setItem("adminLoggedIn","true"),e.innerHTML='<span class="relative z-10 flex items-center justify-center"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Succ√®s !</span>',e.className="w-full bg-gradient-to-r from-green-600 via-emerald-600 to-teal-600 text-white py-3 px-6 rounded-xl font-bold text-lg transition-all duration-500 transform hover:scale-[1.02] active:scale-[0.98] shadow-lg relative overflow-hidden group",setTimeout(()=>{s.user?.role==="admin"?window.location.href="/admin/dashboard":window.location.href="/admin/articles"},800)}catch(t){o.textContent=t.message||"Erreur de connexion",o.classList.remove("hidden"),e.innerHTML='<span class="relative z-10 flex items-center justify-center"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path></svg> Se Connecter</span>',e.disabled=!1,e.className="w-full bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 text-white py-3 px-6 rounded-xl font-bold text-lg hover:from-blue-700 hover:via-purple-700 hover:to-cyan-700 focus:outline-none focus:ring-4 focus:ring-blue-500/30 focus:ring-offset-4 focus:ring-offset-gray-900 transition-all duration-500 transform hover:scale-[1.02] active:scale-[0.98] shadow-lg button-glow hover:shadow-2xl relative overflow-hidden group",document.getElementById("password").value="",o.classList.add("animate-pulse"),setTimeout(()=>o.classList.remove("animate-pulse"),1200)}}catch(t){console.error("üí• Error during login process:",t),o.textContent="Erreur lors de la connexion: "+t.message,o.classList.remove("hidden"),e.innerHTML='<span class="relative z-10 flex items-center justify-center"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path></svg> Se Connecter</span>',e.disabled=!1,e.className="w-full bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 text-white py-3 px-6 rounded-xl font-bold text-lg hover:from-blue-700 hover:via-purple-700 hover:to-cyan-700 focus:outline-none focus:ring-4 focus:ring-blue-500/30 focus:ring-offset-4 focus:ring-offset-gray-900 transition-all duration-500 transform hover:scale-[1.02] active:scale-[0.98] shadow-lg button-glow hover:shadow-2xl relative overflow-hidden group"}},1200)});document.addEventListener("DOMContentLoaded",function(){console.log("üöÄ Login page loaded successfully"),console.log("üåê Current URL:",window.location.href),console.log("üîß User agent:",navigator.userAgent),console.log("‚úÖ Admin session established"),document.querySelectorAll(".float-animation").forEach((n,r)=>{n.style.animationDelay=`${r*2}s`})});
